â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ESP32 â†’ PYTHON â†’ BLYNK INTEGRATION                            â”‚
â”‚                         Complete Data Flow                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STEP 1: ESP32 READS SENSORS
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     ESP32 with FSR       â•‘
â•‘    Pressure Sensors      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ â€¢ Big Toe       (s1)     â•‘
â•‘ â€¢ Pinky Toe     (s2)     â•‘
â•‘ â€¢ Meta Out      (s3)     â•‘
â•‘ â€¢ Meta In       (s4)     â•‘
â•‘ â€¢ Heel          (s5)     â•‘
â•‘                          â•‘
â•‘ â€¢ Left sensors  (s6-s10) â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         â”‚
         â”‚ WiFi HTTP POST
         â”‚ every 2 seconds
         â–¼

STEP 2: PYTHON BACKEND RECEIVES & STORES
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           FastAPI Backend (Port 8000)            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Endpoint: POST /api/pressure                     â•‘
â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘ â”‚ Payload:                                    â”‚  â•‘
â•‘ â”‚ {                                           â”‚  â•‘
â•‘ â”‚   "device_id": "ESP32_01",                  â”‚  â•‘
â•‘ â”‚   "readings": [{                            â”‚  â•‘
â•‘ â”‚     "timestamp": 1234567890,                â”‚  â•‘
â•‘ â”‚     "s1": 42.5,  // bigToe                  â”‚  â•‘
â•‘ â”‚     "s2": 35.2,  // pinkyToe                â”‚  â•‘
â•‘ â”‚     "s3": 38.1,  // metaOut                 â”‚  â•‘
â•‘ â”‚     "s4": 36.4,  // metaIn                  â”‚  â•‘
â•‘ â”‚     "s5": 45.8   // heel                    â”‚  â•‘
â•‘ â”‚   }]                                        â”‚  â•‘
â•‘ â”‚ }                                           â”‚  â•‘
â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘              â†“                                   â•‘
â•‘    Store in PostgreSQL Database                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         â”‚
         â”‚ Call /api/gait-metrics
         â”‚ or /api/blynk/update
         â–¼

STEP 3: PYTHON PROCESSES & ANALYZES
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              Gait Analysis Pipeline                      â•‘
â•‘              (processing.py)                             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ 1. Fetch last 100+ readings from database               â•‘
â•‘    â†“                                                     â•‘
â•‘ 2. Apply Savitzky-Golay Filter (smooth signals)         â•‘
â•‘    â†“                                                     â•‘
â•‘ 3. Detect Heel Strikes (heel pressure rises)            â•‘
â•‘    â†“                                                     â•‘
â•‘ 4. Detect Toe-Offs (forefoot pressure drops)            â•‘
â•‘    â†“                                                     â•‘
â•‘ 5. Calculate Gait Metrics:                              â•‘
â•‘    â€¢ Cadence = 60 / avg(heel_strike_intervals)          â•‘
â•‘    â€¢ Stance Time = toe_off - heel_strike                â•‘
â•‘    â€¢ Swing Time = next_heel_strike - toe_off            â•‘
â•‘    â€¢ Step Symmetry = 100 - |left-right|/max * 100       â•‘
â•‘    â†“                                                     â•‘
â•‘ 6. Calculate Pressure Ratings:                          â•‘
â•‘    â€¢ Compare avg pressure to thresholds                 â•‘
â•‘    â€¢ Output: "Normal", "Weak", or "High"                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         â”‚
         â”‚ Results ready
         â–¼

STEP 4: PYTHON SENDS TO BLYNK
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              Blynk Service                               â•‘
â•‘              (blynk_service.py)                          â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Auth Token: "qCSvSCCeRSutZIb7CPt4Ppvp0qyEij_o"           â•‘
â•‘                                                           â•‘
â•‘ Virtual Pin Assignments:                                 â•‘
â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â•‘
â•‘ â”‚ V0 â†’ Big Toe Rating      ("Normal")          â”‚        â•‘
â•‘ â”‚ V1 â†’ Pinky Toe Rating    ("Normal")          â”‚        â•‘
â•‘ â”‚ V2 â†’ Meta Out Rating     ("Normal")          â”‚        â•‘
â•‘ â”‚ V3 â†’ Meta In Rating      ("Normal")          â”‚        â•‘
â•‘ â”‚ V4 â†’ Heel Rating         ("Normal")          â”‚        â•‘
â•‘ â”‚ V5 â†’ Cadence             (112.5)             â”‚        â•‘
â•‘ â”‚ V6 â†’ Swing Time          (0.45)              â”‚        â•‘
â•‘ â”‚ V7 â†’ Stance Time         (0.68)              â”‚        â•‘
â•‘ â”‚ V8 â†’ Step Symmetry       (94.3)              â”‚        â•‘
â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â•‘
â•‘                                                           â•‘
â•‘ blynk.virtual_write(PIN, value)                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         â”‚
         â”‚ HTTPS to Blynk Cloud
         â–¼

STEP 5: BLYNK DISPLAYS ON MOBILE
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ğŸ“± Blynk Mobile App                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                           â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â•‘
â•‘  â”‚  Pressure Status                           â”‚         â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â•‘
â•‘  â”‚  ğŸŸ¢ Big Toe:     Normal                    â”‚         â•‘
â•‘  â”‚  ğŸŸ¢ Pinky Toe:   Normal                    â”‚         â•‘
â•‘  â”‚  ğŸŸ¢ Meta Out:    Normal                    â”‚         â•‘
â•‘  â”‚  ğŸŸ¢ Meta In:     Normal                    â”‚         â•‘
â•‘  â”‚  ğŸŸ¢ Heel:        Normal                    â”‚         â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â•‘
â•‘                                                           â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â•‘
â•‘  â”‚  Gait Metrics                              â”‚         â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â•‘
â•‘  â”‚  Cadence:         â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘  112.5 spm    â”‚         â•‘
â•‘  â”‚  Swing Time:      0.45 sec                â”‚         â•‘
â•‘  â”‚  Stance Time:     0.68 sec                â”‚         â•‘
â•‘  â”‚  Step Symmetry:   â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘  94.3%       â”‚         â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â•‘
â•‘                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


KEY BENEFITS OF THIS ARCHITECTURE:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… ESP32 is simple - just reads sensors and sends raw data
âœ… Python does all complex calculations (proven algorithms)
âœ… Easy to adjust thresholds and algorithms without reflashing ESP32
âœ… Data stored in database for historical analysis
âœ… Blynk shows processed, meaningful metrics (not raw numbers)
âœ… Can add more metrics without changing ESP32 code
âœ… Python can serve multiple ESP32 devices simultaneously


RATING THRESHOLDS:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Sensor       â”‚  Weak  â”‚  Normal  â”‚  High
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€
Big Toe      â”‚  < 8   â”‚  8-45    â”‚  > 45
Pinky Toe    â”‚  < 5   â”‚  5-40    â”‚  > 40
Meta Out     â”‚  < 20  â”‚  20-50   â”‚  > 50
Meta In      â”‚  < 20  â”‚  20-50   â”‚  > 50
Heel         â”‚  < 15  â”‚  15-55   â”‚  > 55


UPDATE FREQUENCY:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â€¢ ESP32 sends data:  Every 2 seconds
â€¢ Python calculates:  On demand (when endpoint called)
â€¢ Blynk updates:      When /api/gait-metrics or /api/blynk/update called
â€¢ Recommended:        Calculate & send every 5-10 seconds


API ENDPOINTS:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

POST /api/pressure           â†’ Store pressure data from ESP32
GET  /api/readings           â†’ Get recent pressure readings
GET  /api/gait-metrics       â†’ Calculate metrics & auto-send to Blynk
POST /api/blynk/update       â†’ Force Blynk update with latest data


TESTING:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

python backend/test_blynk.py  â†’ Test Blynk connection with mock data
curl localhost:8000/api/gait-metrics  â†’ Test metrics calculation
curl -X POST localhost:8000/api/blynk/update  â†’ Force Blynk update
